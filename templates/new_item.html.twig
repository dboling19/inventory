{% extends 'base.html.twig' %}
{% block title %}New Item{% endblock %}
{% block body %}
{{ include('navbar.html.twig') }}
<div class="db-panel">
  <form action="{{ path('new_item') }}" class="db-panel db-border db-third" id="item_form" method="get">
    <p>
      <label for="name">
        Name
        <input type="text" class="db-input" id="name" name="name"/>
      </label> 
    </p>
    <p>
      <label for="desc">
        Description (Optional)
        <br>
        <textarea class="db-input" id="desc" name="desc"></textarea>
      </label>
    </p>
    <p>
      <label for="date">
        Expiration date
        <br>
        <input type="date" class="db-input" style="width:auto" id="date" name="date"/>
        <br>
        <i style="font-size:12px">Use oldest item's expiration date</i>
      </label>
    </p>
    <p>
      <label for="location">
        Location
        <select class="db-input" id="location" name="location">
          <option value="default">Choose...</option>
        </select>
      </label>
    </p>
    <p>
      <label for="quantity_change">
        Quantity Change
        <input type="text" class="db-input" id="quantity_change" name="quantity_change"/>
        <i style="font-size:12px">Prepend an '-' or '+' to number</i>
      </label>
    </p>
    <p>
      <button type="submit" class="db-button">Create Entry</button>
    </p>
  </form>
</div>
{% if submitted == true %}
  <div class="db-notif">
    <div class="db-center" style="padding:48">
      <h3>Record Saved</h3>
    </div>
  </div>
{% endif %}


<script>
  const post_data = {{ post_data|json_encode()|raw }};
  const locations = {{ locations|json_encode()|raw }};

  window.onload = (event) => {
    const form = document.getElementById('item_form');
    const location_select = document.getElementById('location');
    form.elements['date'].value = post_data['date'];
    for (let i = 0; i < locations.length; i++)
    {
      var option = document.createElement('option');
      option.text = locations[i].name;
      option.value = locations[i].id;
      location_select.add(option);
    } 
  }

  if ( window.history.replaceState ) {
    window.history.replaceState( null, null, window.location.href );
  }
  // 
</script>

{% endblock %}